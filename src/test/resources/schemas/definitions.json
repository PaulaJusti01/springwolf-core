FROM python:3.9-slim

# Diretório padrão do SageMaker
WORKDIR /opt/program

# Instala dependências
COPY requirements.txt /opt/program/requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

# Copia os códigos da aplicação
COPY src/ /opt/program/src/
COPY server/ /opt/program/server/
COPY app.py /opt/program/app.py

# Configurações de ambiente
ENV PYTHONUNBUFFERED=TRUE
ENV PYTHONIOENCODING=UTF-8

# Porta exposta
EXPOSE 8080

# Inicia a API com gunicorn
CMD ["gunicorn", "-b", "0.0.0.0:8080", "app:app"]
