from flask import Flask, Response, request

app = Flask(__name__)

@app.route("/ping", methods=["GET"])
def ping():
    return Response(response="\n", status=200)

@app.route("/invocations", methods=["POST"])
def invocations():
    try:
        data = request.get_json()

        if "instances" in data:
            instance = data["instances"][0]
            if isinstance(instance, dict) and "question" in instance:
                msg = instance["question"]
                return Response(response=f"Pergunta recebida: {msg}", status=200)
            return Response(response=f"Dado recebido: {instance}", status=200)

        elif "question" in data:
            return Response(response=f"Pergunta recebida: {data['question']}", status=200)

        elif "data" in data:
            return Response(response=f"Dado recebido: {data['data']}", status=200)

        else:
            return Response(response="Entrada inv√°lida", status=400)

    except Exception as e:
        return Response(response=f"Erro interno: {str(e)}", status=500)

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=8080)
