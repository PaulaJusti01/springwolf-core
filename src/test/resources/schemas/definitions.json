auto_scaling_data = config_data.get("parameters", {}).get("auto_scaling")

if auto_scaling_data is not None:
    print("########### AUTO SCALING ATIVADO ###########")
    min_task = auto_scaling_data.get("min_task")
    max_task = auto_scaling_data.get("max_task")

    if min_task is None or max_task is None:
        raise ValueError("Parâmetros 'min_task' e 'max_task' são obrigatórios no auto_scaling.")

    if not isinstance(min_task, int) or not isinstance(max_task, int):
        raise ValueError("Os valores de máximo e mínimo devem ser inteiros.")

    if min_task >= max_task:
        raise ValueError("min_task deve ser menor que max_task.")

    parameters.append({
        "Parameter": "AutoScalingMinTask.Default",
        "Type": "literal",
        "Value": min_task,
    })
    parameters.append({
        "Parameter": "AutoScalingMaxTask.Default",
        "Type": "literal",
        "Value": max_task,
    })

    # Verifica CPU e memória
    env_scaling_data = auto_scaling_data.get(env, {})
    cpu_target_value = env_scaling_data.get("target_value")
    memory_target_value = env_scaling_data.get("memory_target_value")

    if cpu_target_value is not None:
        parameters.append({
            "Parameter": "EnableCpuAutoScaling.Default",
            "Type": "literal",
            "Value": "true",
        })
        parameters.append({
            "Parameter": "CpuTargetValue.Default",
            "Type": "literal",
            "Value": cpu_target_value,
        })

    if memory_target_value is not None:
        parameters.append({
            "Parameter": "EnableMemoryAutoScaling.Default",
            "Type": "literal",
            "Value": "true",
        })
        parameters.append({
            "Parameter": "MemoryTargetValue.Default",
            "Type": "literal",
            "Value": memory_target_value,
        })

    if cpu_target_value is None and memory_target_value is None:
        raise ValueError("auto_scaling definido, mas nenhum target (CPU ou memória) foi informado.")

else:
    print("Auto Scaling não definido, seguindo sem configurar.")
